<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0"
		/>
		<script src="https://cdn.tailwindcss.com"></script>
		<title>Home Page</title>
		<script>
			const clearCookies = () => {
				document.cookie =
					"token=; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
				window.location.href = "/";
			};
			function copyToClipboard(url) {
				const tempTextarea =
					document.createElement("textarea");
				tempTextarea.value = `https://url-short-8.vercel.app/url/${url}`;
				document.body.appendChild(tempTextarea);
				tempTextarea.select();
				document.execCommand("copy");
				document.body.removeChild(tempTextarea);
			}
		</script>
	</head>
	<body>
		<nav class="bg-gray-800">
			<div class="mx-auto max-w-7xl px-2 sm:px-6 lg:px-8">
				<div
					class="relative flex h-16 items-center justify-between"
				>
					<div class="flex items-center pr-2 sm:hidden">
						<div
							class="relative w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600"
						>
							<svg
								class="absolute w-12 h-12 text-gray-400 -left-1"
								fill="currentColor"
								viewBox="0 0 20 20"
								xmlns="http://www.w3.org/2000/svg"
							>
								<path
									fill-rule="evenodd"
									d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
									clip-rule="evenodd"
								></path>
							</svg>
						</div>
						<span class="text-white ml-2"
							><%= locals.userName %></span
						>
					</div>
					<div
						class="flex flex-1 items-center justify-center sm:items-stretch sm:justify-start"
					>
						<div class="flex flex-shrink-0 items-center">
							<h1
								class="text-center text-2xl font-bold leading-9 tracking-tight text-white"
							>
								URL Shortner
							</h1>
						</div>
					</div>
					<div
						class="absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0 hidden sm:flex"
					>
						<div
							class="relative w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600"
						>
							<svg
								class="absolute w-12 h-12 text-gray-400 -left-1"
								fill="currentColor"
								viewBox="0 0 20 20"
								xmlns="http://www.w3.org/2000/svg"
							>
								<path
									fill-rule="evenodd"
									d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
									clip-rule="evenodd"
								></path>
							</svg>
						</div>
						<span class="text-white ml-2"
							><%= locals.userName %></span
						>
					</div>
					<input
						type="button"
						value="Logout"
						onClick="clearCookies()"
						class="cursor-pointer text-white ml-5 focus:ring-1 focus:ring-white"
					/>
				</div>
			</div>
		</nav>
		<div class="flex flex-col items-center">
			<% if (locals.id) { %>
			<p>URL Generated:</p>
			<div class="relative">
				<a href="/url/<%= id %>" target="_blank"
					>https://url-short-8.vercel.app/url/<%= id %></a
				>&nbsp;<button
					class="absolute -right-8 cursor-copy"
					onclick="copyToClipboard('<%= id %>')"
				>
					<?xml version="1.0" encoding="utf-8"?><!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
					<svg
						width="24px"
						height="24px"
						viewBox="0 0 24 24"
						fill="none"
						xmlns="http://www.w3.org/2000/svg"
					>
						<path
							fill-rule="evenodd"
							clip-rule="evenodd"
							d="M21 8C21 6.34315 19.6569 5 18 5H10C8.34315 5 7 6.34315 7 8V20C7 21.6569 8.34315 23 10 23H18C19.6569 23 21 21.6569 21 20V8ZM19 8C19 7.44772 18.5523 7 18 7H10C9.44772 7 9 7.44772 9 8V20C9 20.5523 9.44772 21 10 21H18C18.5523 21 19 20.5523 19 20V8Z"
							fill="#0F0F0F"
						/>
						<path
							d="M6 3H16C16.5523 3 17 2.55228 17 2C17 1.44772 16.5523 1 16 1H6C4.34315 1 3 2.34315 3 4V18C3 18.5523 3.44772 19 4 19C4.55228 19 5 18.5523 5 18V4C5 3.44772 5.44772 3 6 3Z"
							fill="#0F0F0F"
						/>
					</svg>
				</button>
			</div>
			<% } %>
			<div>
				<form
					method="POST"
					action="/url"
					class="mt-5 mb-5 w-full"
				>
					<div>
						<label
							for="email"
							class="text-sm font-medium leading-6 text-gray-900"
							>Enter Your URL</label
						>
						<div class="mt-2">
							<input
								type="text"
								id="url"
								name="url"
								autocomplete="url"
								required
								class="pl-[12px] block min-w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-1 focus:ring-emerald-600 dark:focus:ring-emerald-600 sm:text-sm sm:leading-6 m-auto"
							/>
						</div>
					</div>
					<div class="form-group mt-3">
						<button
							type="submit"
							class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-emerald-600 dark:hover:bg-emerald-700 focus:outline-none dark:focus:ring-emerald-800"
						>
							Generate
						</button>
					</div>
				</form>
			</div>
			<div>
				<% if (locals.urls) { %>
				<div
					class="relative overflow-x-auto m-5 outline outline-1 outline-offset-0"
				>
					<table
						class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"
					>
						<thead
							class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"
						>
							<tr>
								<th scope="col" class="px-6 py-3">#</th>
								<th scope="col" class="px-6 py-3">
									Shortened URL
								</th>
								<th scope="col" class="px-6 py-3">
									Redirected
								</th>
								<th scope="col" class="px-6 py-3">
									Clicks
								</th>
							</tr>
						</thead>
						<tbody>
							<% urls.forEach((url , index) => { %>
							<tr
								class="bg-white border-b dark:bg-black-800 dark:border-gray-700"
							>
								<th
									scope="row"
									class="px-6 py-4 font-medium text-black whitespace-nowrap dark:text-black"
								>
									<%= index + 1 %>
								</th>
								<td
									class="px-6 py-4 text-black dark:text-black relative"
								>
									<a href="/url/<%= url.shortId %>"
										><%= url.shortId %></a
									>&nbsp;<button
										class="absolute top-4 cursor-copy"
										onclick="copyToClipboard('<%= url.shortId %>')"
									>
										<?xml version="1.0" encoding="utf-8"?><!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
										<svg
											width="24px"
											height="24px"
											viewBox="0 0 24 24"
											fill="none"
											xmlns="http://www.w3.org/2000/svg"
										>
											<path
												fill-rule="evenodd"
												clip-rule="evenodd"
												d="M21 8C21 6.34315 19.6569 5 18 5H10C8.34315 5 7 6.34315 7 8V20C7 21.6569 8.34315 23 10 23H18C19.6569 23 21 21.6569 21 20V8ZM19 8C19 7.44772 18.5523 7 18 7H10C9.44772 7 9 7.44772 9 8V20C9 20.5523 9.44772 21 10 21H18C18.5523 21 19 20.5523 19 20V8Z"
												fill="#0F0F0F"
											/>
											<path
												d="M6 3H16C16.5523 3 17 2.55228 17 2C17 1.44772 16.5523 1 16 1H6C4.34315 1 3 2.34315 3 4V18C3 18.5523 3.44772 19 4 19C4.55228 19 5 18.5523 5 18V4C5 3.44772 5.44772 3 6 3Z"
												fill="#0F0F0F"
											/>
										</svg>
									</button>
								</td>
								<td
									class="px-6 py-4 text-black break-all max-w-md dark:text-black"
								>
									<%= url.redirectedUrl %>
								</td>
								<td
									class="px-6 py-4 text-black dark:text-black"
								>
									<%= url.visitHistory.length %>
								</td>
							</tr>
							<% }) %>
						</tbody>
					</table>
				</div>
				<% } %>
			</div>
		</div>
	</body>
</html>
